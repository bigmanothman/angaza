<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Company Dashboard | BIGMAN OTHMAN Tech Ltd - ANGAZA</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ====== General Styles ====== */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #f8f9fa;
      min-height: 100vh;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .dashboard-container { display: flex; min-height: 100vh; }

    /* ====== Sidebar Navigation ====== */
    .sidebar {
      width: 260px;
      background: rgba(10, 61, 98, 0.95);
      backdrop-filter: blur(12px);
      padding: 25px 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      transition: all 0.3s ease;
      z-index: 100;
      border-right: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-header {
      padding: 0 25px 25px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 20px;
    }

    .company-brand {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .company-logo {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #ffd32a, #ffc312);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: #0a3d62;
    }

    .company-info h2 { font-size: 1.2rem; color: #ffd32a; margin-bottom: 5px; }
    .company-info p { font-size: 0.8rem; color: rgba(255, 255, 255, 0.7); }

    .nav-menu { padding: 0 15px; }
    .nav-item { margin-bottom: 8px; }
    .nav-link {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    .nav-link:hover, .nav-link.active {
      background: rgba(255, 211, 42, 0.15);
      color: #ffd32a;
      transform: translateX(5px);
    }

    .nav-badge {
      background: #ffd32a;
      color: #0a3d62;
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 10px;
      margin-left: auto;
      font-weight: 600;
    }

    /* ====== Main Content Area ====== */
    .main-content { flex: 1; margin-left: 260px; padding: 20px; transition: margin-left 0.3s ease; }

    /* ====== Top Navigation Bar ====== */
    .top-bar {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 15px 25px;
      margin-bottom: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .search-bar {
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 25px;
      padding: 10px 20px;
      width: 300px;
    }

    .search-bar input {
      background: transparent;
      border: none;
      color: white;
      padding: 0 15px;
      width: 100%;
      outline: none;
    }

    .user-profile { display: flex; align-items: center; gap: 15px; }

    .profile-img {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffd32a, #ffc312);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: #0a3d62;
      cursor: pointer;
      overflow: hidden;
      border: 2px solid #ffd32a;
      transition: transform 0.2s;
    }

    .profile-img:hover { transform: scale(1.05); }
    .profile-img img { width: 100%; height: 100%; object-fit: cover; }

    /* ====== NEW SMART POPUP BOX STYLES ====== */
    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .profile-popup {
      background: linear-gradient(145deg, #162e3d, #0a3d62);
      width: 90%;
      max-width: 400px;
      border-radius: 24px;
      border: 1px solid rgba(255, 211, 42, 0.3);
      padding: 30px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.5);
      position: relative;
      transform: translateY(20px);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .popup-overlay.active { display: flex; }
    .popup-overlay.active .profile-popup { transform: translateY(0); }

    .popup-header {
      text-align: center;
      margin-bottom: 25px;
    }

    .popup-avatar-large {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffd32a, #ffc312);
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      color: #0a3d62;
      border: 4px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
    }
    
    .popup-avatar-large img { width: 100%; height: 100%; object-fit: cover; }

    .popup-actions {
      display: grid;
      gap: 12px;
    }

    .popup-btn {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 14px 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
    }

    .popup-btn:hover {
      background: rgba(255, 211, 42, 0.1);
      border-color: #ffd32a;
      color: #ffd32a;
    }

    .popup-btn i { font-size: 1.1rem; width: 20px; }
    .popup-btn.logout { color: #ff6b6b; border-color: rgba(255, 107, 107, 0.2); }
    .popup-btn.logout:hover { background: rgba(255, 107, 107, 0.1); color: #ff6b6b; border-color: #ff6b6b; }

    .close-popup {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: rgba(255, 255, 255, 0.5);
      font-size: 1.5rem;
      cursor: pointer;
    }

    /* ====== Dashboard UI Elements ====== */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
    }

    .card-icon {
      width: 60px; height: 60px; border-radius: 12px;
      background: rgba(255, 211, 42, 0.15);
      display: flex; align-items: center; justify-content: center;
      font-size: 1.8rem; color: #ffd32a; margin-bottom: 20px;
    }

    .chart-container {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    /* ====== Logout Confirmation Popup Styles ====== */
    .logout-confirm-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 3000;
    }

    .logout-confirm-overlay.active {
      display: flex;
    }

    .logout-confirm-box {
      background: linear-gradient(145deg, #162e3d, #0a3d62);
      width: 90%;
      max-width: 380px;
      border-radius: 20px;
      border: 1px solid rgba(255, 107, 107, 0.3);
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      text-align: center;
      transform: scale(0.9);
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .logout-confirm-overlay.active .logout-confirm-box {
      transform: scale(1);
      opacity: 1;
    }

    .logout-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: rgba(255, 107, 107, 0.15);
      margin: 0 auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: #ff6b6b;
      border: 3px solid rgba(255, 107, 107, 0.3);
    }

    .logout-confirm-box h3 {
      color: #ffd32a;
      margin-bottom: 10px;
      font-size: 1.5rem;
    }

    .logout-confirm-box p {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 25px;
      line-height: 1.5;
    }

    .logout-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .logout-confirm-btn, .logout-cancel-btn {
      padding: 12px 30px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      min-width: 120px;
    }

    .logout-confirm-btn {
      background: linear-gradient(135deg, #ff6b6b, #ff4757);
      color: white;
    }

    .logout-confirm-btn:hover {
      background: linear-gradient(135deg, #ff4757, #ff3838);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
    }

    .logout-cancel-btn {
      background: rgba(255, 255, 255, 0.08);
      color: white;
      border-color: rgba(255, 255, 255, 0.2);
    }

    .logout-cancel-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
    }

    /* ====== Mobile Logic ====== */
    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); width: 280px; }
      .sidebar.active { transform: translateX(0); }
      .main-content { margin-left: 0; }
      .top-bar { flex-direction: column; gap: 15px; }
      .search-bar { width: 100%; }
      .menu-toggle {
        display: flex; position: fixed; top: 20px; left: 20px; z-index: 101;
        background: #0a3d62; border: none; color: white; width: 45px; height: 45px;
        border-radius: 10px; align-items: center; justify-content: center;
      }
      
      .logout-confirm-box {
        padding: 25px 20px;
        max-width: 320px;
      }
      
      .logout-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .logout-confirm-btn, .logout-cancel-btn {
        min-width: 100%;
        padding: 14px 20px;
      }
    }
    
    .menu-toggle { display: none; }
  </style>
</head>
<body>

  <button class="menu-toggle" id="menuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="company-brand">
        <div class="company-logo"><i class="fas fa-laptop-code"></i></div>
        <div class="company-info">
          <h2>BIGMAN OTHMAN Tech Ltd</h2>
          <p>Company Dashboard</p>
        </div>
      </div>
    </div>

    <div class="nav-menu">
      <div class="nav-item"><a href="#" class="nav-link active"><i class="fas fa-chart-line"></i> Dashboard</a></div>
      <div class="nav-item"><a href="#" class="nav-link"><i class="fas fa-file-alt"></i> Job Applications <span class="nav-badge">12</span></a></div>
      <div class="nav-item"><a href="#" class="nav-link"><i class="fas fa-cog"></i> Settings</a></div>
    </div>

    <div style="padding: 25px 20px; margin-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
      <div class="user-profile">
        <div class="profile-img sidebar-profile-display">
          <i class="fas fa-user-tie"></i>
        </div>
        <div>
          <h4 style="color: #ffd32a;">Admin User</h4>
          <p style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.5);">admin@bigmanothman.com</p>
        </div>
      </div>
    </div>
  </nav>

  <main class="main-content">
    <div class="top-bar">
      <div class="search-bar">
        <i class="fas fa-search" style="color: rgba(255, 255, 255, 0.5);"></i>
        <input type="text" placeholder="Search...">
      </div>
      
      <div class="user-profile">
        <div>
          <h4 style="color: white; text-align: right;">Company Admin</h4>
          <p style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.7);">Active Now</p>
        </div>
        <div class="profile-img" id="profileTrigger">
          <i class="fas fa-user-tie"></i>
        </div>
      </div>
    </div>

    <section>
      <div class="dashboard-cards">
        <div class="card">
          <div class="card-icon"><i class="fas fa-file-alt"></i></div>
          <h3>47</h3>
          <p>Total Applications</p>
        </div>
        <div class="card">
          <div class="card-icon"><i class="fas fa-clock"></i></div>
          <h3>12</h3>
          <p>Pending Review</p>
        </div>
      </div>
      <div class="chart-container">
        <div style="height: 300px;"><canvas id="applicationsChart"></canvas></div>
      </div>
    </section>
  </main>

  <div class="popup-overlay" id="popupOverlay">
    <div class="profile-popup">
      <button class="close-popup" id="closePopup">&times;</button>
      
      <div class="popup-header">
        <div class="popup-avatar-large" id="popupAvatar">
          <i class="fas fa-user-tie"></i>
        </div>
        <h3>Admin Settings</h3>
        <p style="color: rgba(255, 255, 255, 0.5); font-size: 0.9rem;">Manage your account & photos</p>
      </div>

      <div class="popup-actions">
        <input type="file" id="imageUpload" accept="image/*" style="display:none">
        
        <label for="imageUpload" class="popup-btn">
          <i class="fas fa-camera"></i>
          <span>Update Profile Photo</span>
        </label>

        <button class="popup-btn" id="deletePhoto">
          <i class="fas fa-trash-alt"></i>
          <span>Remove Photo</span>
        </button>

        <button class="popup-btn" id="viewProfile">
          <i class="fas fa-id-badge"></i>
          <span>View Public Profile</span>
        </button>

        <button class="popup-btn logout" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout Account</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Logout Confirmation Popup -->
  <div class="logout-confirm-overlay" id="logoutConfirmOverlay">
    <div class="logout-confirm-box">
      <div class="logout-icon">
        <i class="fas fa-sign-out-alt"></i>
      </div>
      <h3>Confirm Logout</h3>
      <p>Are you sure you want to logout from your account?</p>
      <div class="logout-buttons">
        <button class="logout-cancel-btn" id="cancelLogoutBtn">Cancel</button>
         <button class="logout-confirm-btn" id="confirmLogoutBtn">Logout</button>
      </div>
    </div>
  </div>
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getAuth, signOut, onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBm4uimZ4UNhT_c-t0Dt0WLUwgmHHIMzzk",
    authDomain: "angazasystem.firebaseapp.com",
    projectId: "angazasystem",
    storageBucket: "angazasystem.firebasestorage.app",
    messagingSenderId: "191988119746",
    appId: "1:191988119746:web:aa050634bc5d57b1bde35b"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // ðŸ” Guard: kama haja-login, rudi login
  onAuthStateChanged(auth, user => {
    if (!user) {
      window.location.href = "/angaza/index.html";
    }
  });

  // ðŸ”´ REAL logout
  window.realLogout = function () {
    signOut(auth).then(() => {
      window.location.href = "/angaza/index.html";
    });
  };
</script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // --- Elements ---
    const profileTrigger = document.getElementById('profileTrigger');
    const popupOverlay = document.getElementById('popupOverlay');
    const closePopup = document.getElementById('closePopup');
    const imageUpload = document.getElementById('imageUpload');
    const popupAvatar = document.getElementById('popupAvatar');
    const sidebarProfileImg = document.querySelector('.sidebar-profile-display');
    const deletePhoto = document.getElementById('deletePhoto');
    const logoutBtn = document.getElementById('logoutBtn');
    const logoutConfirmOverlay = document.getElementById('logoutConfirmOverlay');
    const confirmLogoutBtn = document.getElementById('confirmLogoutBtn');
    const cancelLogoutBtn = document.getElementById('cancelLogoutBtn');

    // --- Popup Control ---
    profileTrigger.addEventListener('click', () => {
      popupOverlay.classList.add('active');
    });

    closePopup.addEventListener('click', () => {
      popupOverlay.classList.remove('active');
    });

    // Close when clicking outside the box
    popupOverlay.addEventListener('click', (e) => {
      if (e.target === popupOverlay) popupOverlay.classList.remove('active');
    });

    // --- Profile Picture Logic ---
    imageUpload.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          const imgUrl = event.target.result;
          const imgHtml = `<img src="${imgUrl}" alt="Profile">`;
          
          // Update all instances
          profileTrigger.innerHTML = imgHtml;
          popupAvatar.innerHTML = imgHtml;
          sidebarProfileImg.innerHTML = imgHtml;
          
          // Close popup after selection (optional)
          // setTimeout(() => popupOverlay.classList.remove('active'), 500);
        };
        reader.readAsDataURL(file);
      }
    });

    deletePhoto.addEventListener('click', () => {
      const defaultIcon = '<i class="fas fa-user-tie"></i>';
      profileTrigger.innerHTML = defaultIcon;
      popupAvatar.innerHTML = defaultIcon;
      sidebarProfileImg.innerHTML = defaultIcon;
      imageUpload.value = "";
    });

    // --- Logout Functionality ---
    logoutBtn.addEventListener('click', () => {
      // Close the profile popup
      popupOverlay.classList.remove('active');
      // Show the logout confirmation popup
      logoutConfirmOverlay.classList.add('active');
    });

    // Confirm logout
    confirmLogoutBtn.addEventListener('click', () => {
      // Redirect to home page
     realLogout();
    });

    // Cancel logout
    cancelLogoutBtn.addEventListener('click', () => {
      logoutConfirmOverlay.classList.remove('active');
    });

    // Close logout confirmation when clicking outside the box
    logoutConfirmOverlay.addEventListener('click', (e) => {
      if (e.target === logoutConfirmOverlay) {
        logoutConfirmOverlay.classList.remove('active');
      }
    });

    // Close logout confirmation with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && logoutConfirmOverlay.classList.contains('active')) {
        logoutConfirmOverlay.classList.remove('active');
      }
    });

    // --- Chart JS ---
    const ctx = document.getElementById('applicationsChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
          label: 'Activity',
          data: [12, 19, 15, 25, 22, 30, 45],
          borderColor: '#ffd32a',
          backgroundColor: 'rgba(255, 211, 42, 0.1)',
          fill: true,
          tension: 0.4
        }]
      },
      options: { responsive: true, maintainAspectRatio: false }
    });

    // Mobile Menu
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    menuToggle.addEventListener('click', () => sidebar.classList.toggle('active'));
  </script>
</body>
</html>


